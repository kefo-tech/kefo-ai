<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <!-- =========================
       [SEO/HEAD] Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© + SEO
       =========================
       Ø§Ù„Ù‡Ø¯Ù: ØªØ­Ø³ÙŠÙ† Ø¸Ù‡ÙˆØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙÙŠ Google + ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ§Øª.
  -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>KeFo.tech | KeFo AI - One Word Search AI | Zakaria KeFo | Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ</title>

  <!-- ÙˆØµÙ Ù…Ø®ØªØµØ±: ÙŠØ¸Ù‡Ø± ØºØ§Ù„Ø¨Ø§Ù‹ ØªØ­Øª Ù†ØªÙŠØ¬Ø© Google -->
  <meta name="description" content="KeFo AI Ù…Ù† KeFo.tech: Ù…Ù†ØµØ© Ø¨Ø­Ø« Ø°ÙƒÙŠØ© Ø¨ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø© (One Word Search AI) ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Wikipedia API. ØªØ·ÙˆÙŠØ±: Zakaria KeFo (Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ). ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ©: KeFo ai, KeFo.tech, one word search ai, Ø§Ù„Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø©." />

  <!-- canonical Ù…Ù‡Ù… Ù„ØªÙØ§Ø¯ÙŠ ØªÙƒØ±Ø§Ø± Ø§Ù„Ù†Ø³Ø® ÙÙŠ Ø§Ù„Ø£Ø±Ø´ÙØ© -->
  <link rel="canonical" href="https://kefo-tech.github.io/kefo-ai/" />

  <!-- Open Graph -->
  <meta property="og:title" content="KeFo.tech | KeFo AI - One Word Search AI" />
  <meta property="og:description" content="Ù…Ù†ØµØ© Ø¨Ø­Ø« Ø°ÙƒÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙˆÙŠÙƒÙŠØ¨ÙŠØ¯ÙŠØ§. ØªØ·ÙˆÙŠØ±: Zakaria KeFo (Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ) | KeFo.tech" />
  <meta property="og:url" content="https://kefo-tech.github.io/kefo-ai/" />
  <meta property="og:type" content="website" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="KeFo.tech | KeFo AI - One Word Search AI" />
  <meta name="twitter:description" content="Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ø¨Ø± Wikipedia API. Zakaria KeFo | Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ | KeFo.tech" />

  <!-- JSON-LD: ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¨Ø­Ø« -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "KeFo.tech - KeFo AI",
    "url": "https://kefo-tech.github.io/kefo-ai/",
    "alternateName": [
      "KeFo AI",
      "KeFo.tech",
      "KeFo ai",
      "Zakaria KeFo",
      "Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ",
      "One Word Search AI",
      "Ø§Ù„Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø©"
    ],
    "description": "One Word Search AI platform powered by Wikipedia API. Ù…Ù†ØµØ© Ø¨Ø­Ø« Ø°ÙƒÙŠØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙˆÙŠÙƒÙŠØ¨ÙŠØ¯ÙŠØ§."
  }
  </script>

  <!-- =========================
       [Fonts] Ø®Ø·ÙˆØ· Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ
       ========================= -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    /* =========================
       [1] Reset + Ù…Ù†Ø¹ ØªÙ…Ø±ÙŠØ± Ø§Ù„ØµÙØ­Ø©
       =========================
       Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø­Ù„ Ø§Ù„Ø¬Ø°Ø±ÙŠ Ù„Ù…Ø´ÙƒÙ„Ø© "Ø§Ù„Ù†ØªÙŠØ¬Ø© ØªÙ†Ø²Ù„ ÙˆØªØ¯ÙØ¹ Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ù„Ø£Ø³ÙÙ„":
       - Ù†Ù…Ù†Ø¹ scroll Ø¹Ù„Ù‰ body/html
       - ÙˆÙ†Ø³Ù…Ø­ Ø¨Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙ‚Ø· Ø¯Ø§Ø®Ù„ #conversation
    */
    *, *::before, *::after { box-sizing: border-box; }

    html, body {
      height: 100%;
      overflow: hidden;
    }

    /* =========================
       [2] Variables (Dark Theme)
       ========================= */
    :root{
      --bg: #000;
      --text: #0f0;
      --panel: rgba(0,0,0,0.85);
      --panel2: rgba(0,0,0,0.92);
      --border: #0f0;
      --bubble: rgba(0,128,0,0.2);
      --bubble-user: rgba(0,255,0,0.3);
      --shadow: 0 0 20px var(--border);
      --muted: rgba(0,255,0,0.75);
      --btn-bg: #000;
      --btn-text: #0f0;
      --btn-hover-bg: #0f0;
      --btn-hover-text: #000;
      --font: "Courier New", Courier, monospace;
      --maxw: 720px;
    }

    /* =========================
       [3] Light Theme
       =========================
       Ø·Ù„Ø¨Øª Ø®Ø· ÙˆØ§Ø¶Ø­ Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ + Ù‚Ø±Ø§Ø¡Ø© Ø£ÙØ¶Ù„.
    */
    body.theme-light{
      --bg: #f7f9ff;
      --text: #102a10;
      --panel: rgba(255,255,255,0.92);
      --panel2: rgba(255,255,255,0.97);
      --border: #153a15;
      --bubble: rgba(21,58,21,0.08);
      --bubble-user: rgba(21,58,21,0.12);
      --shadow: 0 10px 26px rgba(0,0,0,0.12);
      --muted: rgba(16,42,16,0.7);
      --btn-bg: #ffffff;
      --btn-text: #153a15;
      --btn-hover-bg: #153a15;
      --btn-hover-text: #ffffff;
      --font: "Cairo", "Inter", system-ui, -apple-system, "Segoe UI", Arial, sans-serif;
    }

    /* =========================
       [4] Body + App layout
       ========================= */
    body {
      font-family: var(--font);
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 0;
      user-select: none;
      display: flex;
      justify-content: center;
    }

    /*
      .app:
      - Ù…Ø³Ø§Ø­Ø© Ø³ÙÙ„ÙŠØ© ÙƒØ§ÙÙŠØ© Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ + Ø§Ù„Ø­Ù‚ÙˆÙ‚
    */
    .app {
      width: 100%;
      max-width: var(--maxw);
      display: flex;
      flex-direction: column;
      height: 100vh;
      padding: 10px;
      padding-bottom: 160px;
      gap: 10px;
    }

    /* =========================
       [5] Header
       ========================= */
    .header {
      position: sticky;
      top: 0;
      z-index: 50;
      background: var(--panel2);
      border: 1px solid var(--border);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 10px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .header h1{
      margin: 0;
      font-size: 1.15rem;
      text-shadow: 0 0 10px var(--border), 0 0 20px var(--border);
      line-height: 1.2;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .header-actions{
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: nowrap;
    }

    .icon-btn{
      background: var(--btn-bg);
      color: var(--btn-text);
      border: 1px solid var(--border);
      width: 40px;
      height: 40px;
      border-radius: 10px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 10px rgba(0,255,0,0.15);
      transition: transform 0.12s ease, background 0.12s ease, color 0.12s ease;
      font-size: 18px;
    }
    .icon-btn:hover{
      background: var(--btn-hover-bg);
      color: var(--btn-hover-text);
      transform: scale(1.05);
    }

    /* =========================
       [6] Chat container + Conversation (scroll Ù‡Ù†Ø§ ÙÙ‚Ø·)
       ========================= */
    #chat-container {
      border: 1px solid var(--border);
      background: var(--panel);
      border-radius: 12px;
      box-shadow: var(--shadow);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      flex: 1;
      min-height: 0;
    }

    #conversation {
      padding: 12px;
      background: var(--panel2);
      overflow-y: auto;
      flex: 1;
      min-height: 0;
      scroll-behavior: auto;
      overscroll-behavior: contain;
      direction: rtl;
    }

    .message-bubble {
      background: var(--bubble);
      color: var(--text);
      padding: 10px;
      border: 1px solid var(--border);
      border-radius: 10px;
      margin: 10px 0;
      max-width: 92%;
      word-wrap: break-word;
      line-height: 1.7;
    }

    .user-bubble {
      margin-right: auto;
      background: var(--bubble-user);
    }

    .article-container {
      padding: 14px;
      background: rgba(0, 128, 0, 0.08);
      border: 1px solid var(--border);
      border-radius: 12px;
      margin: 12px 0;
    }
    body.theme-light .article-container{ background: rgba(21,58,21,0.06); }

    .typing-effect { white-space: pre-wrap; }

    .signature {
      margin-top: 8px;
      font-size: 14px;
      color: var(--muted);
      text-align: left;
      font-style: italic;
    }

    .copy-btn {
      background: var(--btn-bg);
      color: var(--btn-text);
      border: 1px solid var(--border);
      padding: 9px 14px;
      font-size: 14px;
      cursor: pointer;
      border-radius: 10px;
      margin-top: 12px;
      display: inline-block;
      transition: transform 0.12s ease, background 0.12s ease, color 0.12s ease;
    }
    .copy-btn:hover {
      background: var(--btn-hover-bg);
      color: var(--btn-hover-text);
      transform: scale(1.03);
    }

    /* =========================
       [7] Input Bar (Fixed bottom)
       ========================= */
    #input-container {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 34px;
      width: calc(100% - 20px);
      max-width: var(--maxw);
      z-index: 60;

      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px;
      background: var(--panel2);
      border: 1px solid var(--border);
      border-radius: 12px 12px 0 0;
      box-shadow: var(--shadow);
    }

    #userInput {
      flex: 1;
      padding: 12px;
      font-size: 16px;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: var(--btn-bg);
      color: var(--btn-text);
      caret-color: var(--border);
      outline: none;
    }

    #sendBtn {
      background: var(--btn-bg);
      color: var(--btn-text);
      border: 1px solid var(--border);
      padding: 12px 18px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 10px;
      white-space: nowrap;
      transition: transform 0.12s ease, background 0.12s ease, color 0.12s ease;
    }
    #sendBtn:hover {
      background: var(--btn-hover-bg);
      color: var(--btn-hover-text);
      transform: scale(1.03);
    }

    /* =========================
       [8] Copyright Bar (Fixed)
       =========================
       Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¨Ø§Ù„Ù†Øµ Ø­Ø³Ø¨ Ù„ØºØ© Ø§Ù„Ø¬Ù‡Ø§Ø² Ø¹Ø¨Ø± JS.
    */
    #copyright-bar{
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 0;
      width: calc(100% - 20px);
      max-width: var(--maxw);
      z-index: 59;

      background: var(--panel2);
      border: 1px solid var(--border);
      border-top: none;
      border-radius: 0 0 12px 12px;
      box-shadow: var(--shadow);

      padding: 8px 10px;
      font-size: 12px;
      text-align: center;
      opacity: 0.95;
    }
    #copyright-bar a{
      color: var(--text);
      text-decoration: none;
      border-bottom: 1px dashed var(--border);
    }

    /* =========================
       [9] Notifications
       ========================= */
    .notification {
      position: fixed;
      bottom: 140px;
      right: 20px;
      background: var(--border);
      color: var(--btn-hover-text);
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: bold;
      box-shadow: var(--shadow);
      z-index: 200;
      transition: opacity 0.5s ease-in-out;
      max-width: calc(100% - 40px);
    }

    /* =========================
       [10] Drawers (Settings / Donate / About)
       ========================= */
    .drawer{
      position: fixed;
      inset: 0;
      z-index: 100;
      display: none;
    }
    .drawer.open{ display: block; }

    .drawer-backdrop{
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.55);
    }

    .drawer-panel{
      position: absolute;
      top: 12px;
      left: 12px;
      right: 12px;
      max-width: var(--maxw);
      margin: 0 auto;
      background: var(--panel2);
      border: 1px solid var(--border);
      border-radius: 14px;
      box-shadow: var(--shadow);
      padding: 12px;
    }

    .drawer-panel h2{
      margin: 0 0 10px 0;
      font-size: 1.05rem;
    }

    .setting-row{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 10px;
      border: 1px dashed var(--border);
      border-radius: 12px;
      background: var(--panel);
      margin-bottom: 10px;
    }

    .toggle{
      display: inline-flex;
      gap: 10px;
      align-items: center;
      cursor: pointer;
      user-select: none;
    }
    .toggle input{ display:none; }

    .toggle-pill{
      width: 54px;
      height: 30px;
      border-radius: 99px;
      border: 1px solid var(--border);
      background: var(--btn-bg);
      position: relative;
    }
    .toggle-pill::after{
      content: "";
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--border);
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      right: 3px;
      transition: right 0.2s ease;
    }
    .toggle input:checked + .toggle-pill::after{ right: 27px; }

    .btn{
      background: var(--btn-bg);
      color: var(--btn-text);
      border: 1px solid var(--border);
      padding: 10px 14px;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.12s ease, background 0.12s ease, color 0.12s ease;
      font-size: 14px;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .btn:hover{
      background: var(--btn-hover-bg);
      color: var(--btn-hover-text);
      transform: scale(1.03);
    }

    .drawer-footer{
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      padding-top: 6px;
    }

    /* =========================
       [11] About SEO block (Ù…Ø±Ø¦ÙŠ Ù„ÙƒÙ† Ù„Ø·ÙŠÙ)
       =========================
       Ù…Ù‡Ù… Ù„Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¨Ø­Ø«: Ù†Øµ Ø­Ù‚ÙŠÙ‚ÙŠ ÙŠÙ…ÙƒÙ† Ù‚Ø±Ø§Ø¡ØªÙ‡ØŒ Ø¨Ø¯ÙˆÙ† Ø¥ÙØ³Ø§Ø¯ Ø§Ù„ØªØµÙ…ÙŠÙ….
       ÙˆØ¶Ø¹ØªÙ‡ Ø¯Ø§Ø®Ù„ Drawer "About" + Ø³Ù†Ø¶ÙŠÙ ÙÙ‚Ø±Ø© Ù‚ØµÙŠØ±Ø© Ø£ÙŠØ¶Ø§Ù‹ Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙØ­Ø©.
    */
    .seo-inline{
      font-size: 12px;
      opacity: 0.85;
      line-height: 1.7;
      margin-top: 6px;
      border: 1px dashed var(--border);
      border-radius: 12px;
      padding: 10px;
      background: var(--panel);
    }

    /* =========================
       [12] Language Modal (First run)
       ========================= */
    .lang-modal{
      position: fixed;
      inset: 0;
      z-index: 300;
      display: none;
      background: rgba(0,0,0,0.7);
    }
    .lang-modal.open{ display: grid; place-items: center; }

    .lang-card{
      width: calc(100% - 24px);
      max-width: 520px;
      background: var(--panel2);
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: var(--shadow);
      padding: 14px;
    }

    .lang-card h3{
      margin: 0 0 10px 0;
      font-size: 1.05rem;
      line-height: 1.5;
    }

    .lang-grid{
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
    }

    .lang-btn{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: var(--panel);
      cursor: pointer;
      transition: transform 0.12s ease, background 0.12s ease;
    }
    .lang-btn:hover{
      transform: scale(1.01);
      background: rgba(0,255,0,0.08);
    }
    body.theme-light .lang-btn:hover{
      background: rgba(21,58,21,0.08);
    }

    .lang-left{
      display:flex;
      align-items:center;
      gap:10px;
    }

    .flag{ font-size: 20px; line-height: 1; }
    .lang-name{ font-weight: 700; }
    .lang-code{ font-size: 12px; opacity: 0.8; }

    /* =========================
       [13] Responsive
       ========================= */
    @media (max-width: 600px) {
      .app{ padding: 8px; padding-bottom: 170px; }
      .header h1 { font-size: 1.05rem; }
      #sendBtn { padding: 12px 14px; font-size: 15px; }
      .message-bubble { max-width: 100%; font-size: 14px; }
      #input-container { width: calc(100% - 16px); bottom: 34px; }
      #copyright-bar { width: calc(100% - 16px); }
    }
  </style>
</head>

<body>
  <!-- =========================
       [APP] Header + Chat
       ========================= -->
  <div class="app">
    <div class="header">
      <h1 id="appTitle">KeFo AI</h1>

      <!-- Ø£Ø²Ø±Ø§Ø± Ø£Ø¹Ù„Ù‰: About + Donate + Settings -->
      <div class="header-actions">
        <button class="icon-btn" id="aboutBtn" title="Ø­ÙˆÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹" aria-label="Ø­ÙˆÙ„">â„¹ï¸</button>
        <button class="icon-btn" id="donateBtn" title="ØªØ¨Ø±Ø¹ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹" aria-label="ØªØ¨Ø±Ø¹">ğŸ’š</button>
        <button class="icon-btn" id="settingsBtn" title="Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª" aria-label="Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª">âš™ï¸</button>
      </div>
    </div>

    <!-- Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ø®ØªÙŠØ§Ø±ÙŠØ© -->
    <audio id="background-music" preload="none" controls style="display:none">
      <source src="https://assets.mixkit.co/active_storage/sfx/2467/2467-preview.mp3" type="audio/mpeg" />
    </audio>

    <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© -->
    <div id="chat-container">
      <div id="conversation">
        <!-- Anchor: ÙŠØ¨Ù‚ÙŠ Ø¢Ø®Ø± Ø³Ø·Ø± Ø¸Ø§Ù‡Ø± Ø¯Ø§Ø¦Ù…Ø§Ù‹ -->
        <div id="bottomAnchor" style="height:1px;"></div>
      </div>
    </div>

    <!-- =========================
         [SEO Inline Text]
         =========================
         ÙƒØªÙ„Ø© Ù†Øµ ØµØºÙŠØ±Ø© ÙˆÙ…Ø±Ø¦ÙŠØ© Ù„Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¨Ø­Ø« (Ù„Ø§ ØªØ²Ø¹Ø¬ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…).
         Ø³ÙŠØªÙ… ØªØ±Ø¬Ù…ØªÙ‡Ø§ Ø­Ø³Ø¨ Ù„ØºØ© Ø§Ù„Ø¬Ù‡Ø§Ø².
    -->
    <div class="seo-inline" id="seoInlineText"></div>
  </div>

  <!-- =========================
       [INPUT] Ø´Ø±ÙŠØ· Ø¥Ø¯Ø®Ø§Ù„ Ø«Ø§Ø¨Øª
       ========================= -->
  <div id="input-container">
    <input type="text" id="userInput" placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø£Ùˆ Ø¬Ù…Ù„Ø© Ù„Ù„Ø¨Ø­Ø«" />
    <button id="sendBtn">Ø¨Ø­Ø«</button>
  </div>

  <!-- =========================
       [COPYRIGHT] Ø³Ø·Ø± Ø­Ù‚ÙˆÙ‚ Ø«Ø§Ø¨Øª (Ù…ØªØ±Ø¬Ù… Ø­Ø³Ø¨ Ù„ØºØ© Ø§Ù„Ø¬Ù‡Ø§Ø²)
       ========================= -->
  <div id="copyright-bar"></div>

  <!-- =========================
       [DRAWER] Settings
       ========================= -->
  <div class="drawer" id="settingsDrawer" aria-hidden="true">
    <div class="drawer-backdrop" id="settingsBackdrop"></div>

    <div class="drawer-panel" role="dialog" aria-modal="true" aria-label="Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª">
      <h2 id="settingsTitle">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>

      <div class="setting-row">
        <div id="themeRowLabel">Ø§Ù„ÙˆØ¶Ø¹</div>
        <label class="toggle" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ/Ù†Ù‡Ø§Ø±ÙŠ">
          <input type="checkbox" id="themeToggle" />
          <span class="toggle-pill"></span>
          <span id="themeLabel">Ù„ÙŠÙ„ÙŠ</span>
        </label>
      </div>

      <div class="setting-row">
        <div id="langRowLabel">Ø§Ù„Ù„ØºØ©</div>
        <div style="display:flex; gap:10px; align-items:center;">
          <span id="currentLangLabel" style="opacity:.9;"></span>
          <button class="btn" id="changeLangBtn">ØªØºÙŠÙŠØ±</button>
        </div>
      </div>

      <div class="drawer-footer">
        <button class="btn" id="closeSettingsBtn">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
    </div>
  </div>

  <!-- =========================
       [DRAWER] Donate (PayPal)
       ========================= -->
  <div class="drawer" id="donateDrawer" aria-hidden="true">
    <div class="drawer-backdrop" id="donateBackdrop"></div>

    <div class="drawer-panel" role="dialog" aria-modal="true" aria-label="Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¨Ø±Ø¹">
      <h2 id="donateTitle">Ø¯Ø¹Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</h2>

      <div class="setting-row" style="flex-direction:column; align-items:stretch; gap:10px;">
        <div id="donateText" style="line-height:1.8;"></div>

        <!-- Ø±Ø§Ø¨Ø· PayPal Ø§Ù„Ø°ÙŠ Ø²ÙˆÙ‘Ø¯ØªÙ†ÙŠ Ø¨Ù‡ -->
        <a id="paypalDonateLink" class="btn"
           target="_blank" rel="noopener"
           href="https://py.pl/1T9xYzLe4cnWzyr45JFynw">
          Donate via PayPal
        </a>

        <div style="font-size:12px; opacity:.85;" id="donateHint"></div>
      </div>

      <div class="drawer-footer">
        <button class="btn" id="closeDonateBtn">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
    </div>
  </div>

  <!-- =========================
       [DRAWER] About (SEO + Ø´Ø±Ø­ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹)
       ========================= -->
  <div class="drawer" id="aboutDrawer" aria-hidden="true">
    <div class="drawer-backdrop" id="aboutBackdrop"></div>

    <div class="drawer-panel" role="dialog" aria-modal="true" aria-label="Ø­ÙˆÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹">
      <h2 id="aboutTitle">Ø­ÙˆÙ„ KeFo AI</h2>

      <div class="setting-row" style="flex-direction:column; align-items:stretch; gap:10px;">
        <div id="aboutText" style="line-height:1.9;"></div>

        <div style="font-size:12px; opacity:.85;" id="aboutKeywords"></div>

        <a class="btn" target="_blank" rel="noopener"
           href="https://kefo-tech.github.io/kefo-ai/">
          KeFo.tech / KeFo AI
        </a>
      </div>

      <div class="drawer-footer">
        <button class="btn" id="closeAboutBtn">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
    </div>
  </div>

  <!-- =========================
       [LANG MODAL] Ø§Ø®ØªÙŠØ§Ø± Ù„ØºØ© Ù†ØªØ§Ø¦Ø¬ ÙˆÙŠÙƒÙŠØ¨ÙŠØ¯ÙŠØ§ (Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)
       ========================= -->
  <div class="lang-modal" id="langModal">
    <div class="lang-card">
      <h3 id="langPrompt">Ø§Ø®ØªØ± Ù„ØºØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>

      <div class="lang-grid">
        <button class="lang-btn" data-lang="ar">
          <div class="lang-left">
            <span class="flag">ğŸ‡µğŸ‡¸</span>
            <div>
              <div class="lang-name">Ø¹Ø±Ø¨ÙŠ</div>
              <div class="lang-code">Wikipedia: ar</div>
            </div>
          </div>
          <span>â†’</span>
        </button>

        <button class="lang-btn" data-lang="en">
          <div class="lang-left">
            <span class="flag">ğŸ‡¬ğŸ‡§</span>
            <div>
              <div class="lang-name">English</div>
              <div class="lang-code">Wikipedia: en</div>
            </div>
          </div>
          <span>â†’</span>
        </button>

        <button class="lang-btn" data-lang="de">
          <div class="lang-left">
            <span class="flag">ğŸ‡©ğŸ‡ª</span>
            <div>
              <div class="lang-name">Deutsch</div>
              <div class="lang-code">Wikipedia: de</div>
            </div>
          </div>
          <span>â†’</span>
        </button>
      </div>

      <div style="margin-top:12px; font-size:12px; opacity:.85;" id="langHint">
        Ø³ÙŠØªÙ… ØªØ°ÙƒØ± Ø§Ø®ØªÙŠØ§Ø±Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.
      </div>
    </div>
  </div>

  <script>
    /* =========================
       [1] DOM References + Storage
       ========================= */
    const conversationContainer = document.getElementById('conversation');
    const bottomAnchor = document.getElementById('bottomAnchor');

    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');

    const settingsBtn = document.getElementById('settingsBtn');
    const settingsDrawer = document.getElementById('settingsDrawer');
    const settingsBackdrop = document.getElementById('settingsBackdrop');
    const closeSettingsBtn = document.getElementById('closeSettingsBtn');

    const donateBtn = document.getElementById('donateBtn');
    const donateDrawer = document.getElementById('donateDrawer');
    const donateBackdrop = document.getElementById('donateBackdrop');
    const closeDonateBtn = document.getElementById('closeDonateBtn');

    const aboutBtn = document.getElementById('aboutBtn');
    const aboutDrawer = document.getElementById('aboutDrawer');
    const aboutBackdrop = document.getElementById('aboutBackdrop');
    const closeAboutBtn = document.getElementById('closeAboutBtn');

    const themeToggle = document.getElementById('themeToggle');
    const themeLabel = document.getElementById('themeLabel');

    const langModal = document.getElementById('langModal');
    const langPrompt = document.getElementById('langPrompt');
    const changeLangBtn = document.getElementById('changeLangBtn');
    const currentLangLabel = document.getElementById('currentLangLabel');

    const seoInlineText = document.getElementById('seoInlineText');
    const copyrightBar = document.getElementById('copyright-bar');

    const STORAGE_THEME = 'kefotube_science_theme';
    const STORAGE_LANG  = 'kefotube_science_lang';

    let isMusicPlayed = false;
    let wikiLang = 'ar'; // Ù„ØºØ© Ù†ØªØ§Ø¦Ø¬ ÙˆÙŠÙƒÙŠØ¨ÙŠØ¯ÙŠØ§

    /* =========================
       [2] Ø¥Ø¨Ù‚Ø§Ø¡ Ø¢Ø®Ø± Ø³Ø·Ø±/Ø­Ø±Ù Ø¸Ø§Ù‡Ø± Ø¯Ø§Ø¦Ù…Ø§Ù‹
       ========================= */
    function keepLastLineVisible() {
      bottomAnchor.scrollIntoView({ behavior: 'auto', block: 'end' });
    }

    /* =========================
       [3] Drawer helpers
       ========================= */
    function openDrawer(drawer){
      drawer.classList.add('open');
      drawer.setAttribute('aria-hidden', 'false');
    }
    function closeDrawer(drawer){
      drawer.classList.remove('open');
      drawer.setAttribute('aria-hidden', 'true');
    }

    settingsBtn.addEventListener('click', () => openDrawer(settingsDrawer));
    settingsBackdrop.addEventListener('click', () => closeDrawer(settingsDrawer));
    closeSettingsBtn.addEventListener('click', () => closeDrawer(settingsDrawer));

    donateBtn.addEventListener('click', () => openDrawer(donateDrawer));
    donateBackdrop.addEventListener('click', () => closeDrawer(donateDrawer));
    closeDonateBtn.addEventListener('click', () => closeDrawer(donateDrawer));

    aboutBtn.addEventListener('click', () => openDrawer(aboutDrawer));
    aboutBackdrop.addEventListener('click', () => closeDrawer(aboutDrawer));
    closeAboutBtn.addEventListener('click', () => closeDrawer(aboutDrawer));

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeDrawer(settingsDrawer);
        closeDrawer(donateDrawer);
        closeDrawer(aboutDrawer);
        closeLangModal();
      }
    });

    /* =========================
       [4] Theme (Ù„ÙŠÙ„ÙŠ/Ù†Ù‡Ø§Ø±ÙŠ)
       ========================= */
    function applyTheme(theme) {
      const isLight = theme === 'light';
      document.body.classList.toggle('theme-light', isLight);
      themeToggle.checked = isLight;
      themeLabel.textContent = isLight ? 'Ù†Ù‡Ø§Ø±ÙŠ' : 'Ù„ÙŠÙ„ÙŠ';
      localStorage.setItem(STORAGE_THEME, theme);
    }

    (function initTheme(){
      const saved = localStorage.getItem(STORAGE_THEME) || 'dark';
      applyTheme(saved);
    })();

    themeToggle.addEventListener('change', () => {
      applyTheme(themeToggle.checked ? 'light' : 'dark');
    });

    /* =========================
       [5] UI language (Ù„ØºØ© Ø§Ù„Ø¬Ù‡Ø§Ø²)
       =========================
       Ù‡Ø°Ù‡ Ø§Ù„Ù„ØºØ© ØªØ³ØªØ®Ø¯Ù… Ù„Ù„Ù†ØµÙˆØµ: Ø§Ù„ØªØ¨Ø±Ø¹/Ø­ÙˆÙ„/Ø§Ù„Ø­Ù‚ÙˆÙ‚/Ø§Ù„Ø±Ø³Ø§Ø¦Ù„... Ø¥Ù„Ø®
    */
    function getDeviceUILang(){
      const l = (navigator.language || 'en').toLowerCase();
      if (l.startsWith('ar')) return 'ar';
      if (l.startsWith('de')) return 'de';
      return 'en';
    }
    const uiLang = getDeviceUILang();

    /* =========================
       [6] i18n texts
       ========================= */
    const uiText = {
      ar: {
        welcomeMsg: "Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø£Ùˆ Ù…ØµØ·Ù„Ø­Ø§Ù‹ØŒ ÙˆØ³Ø£Ø¹Ø±Ø¶ Ù„Ùƒ Ù†ØªØ§Ø¦Ø¬ ÙˆÙŠÙƒÙŠØ¨ÙŠØ¯ÙŠØ§ Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©.",
        inputPlaceholder: "Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø£Ùˆ Ø¬Ù…Ù„Ø© Ù„Ù„Ø¨Ø­Ø«",
        searchBtn: "Ø¨Ø­Ø«",
        noTerm: "â— ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ù„Ù„Ø¨Ø­Ø«",
        searching: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...",
        results: "ğŸ“„ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« (Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø±Ø­):",
        fetching: "ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø´Ø±Ø­...",
        noResults: (t)=>`Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„ÙƒÙ„Ù…Ø©: "${t}"`,
        searchErr: "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø¨Ø­Ø«ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§.",
        fetchErr: "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ø´Ø±Ø­ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§.",
        copyBtn: "Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©",
        copied: "âœ… ØªÙ…!",
        copyFail: "âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ù†Ø³Ø®!",
        signature: "Ø¨Ù‚Ù„Ù… Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ",

        settingsTitle: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
        mode: "Ø§Ù„ÙˆØ¶Ø¹",
        language: "Ø§Ù„Ù„ØºØ©",
        change: "ØªØºÙŠÙŠØ±",
        close: "Ø¥ØºÙ„Ø§Ù‚",

        langPrompt: "Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø§Ø®ØªØ± Ù„ØºØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬",
        langHint: "Ø³ÙŠØªÙ… ØªØ°ÙƒØ± Ø§Ø®ØªÙŠØ§Ø±Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
        currentLang: (code)=>({ar:"Ø¹Ø±Ø¨ÙŠ",en:"English",de:"Deutsch"}[code]||code),

        donateTitle: "Ø¯Ø¹Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹",
        donateText: `Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù†ØµØ© Ù…Ø¬Ø§Ù†ÙŠØ© Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ø¹Ù„ÙˆÙ…Ø© Ø¹Ø¨Ø± ÙˆÙŠÙƒÙŠØ¨ÙŠØ¯ÙŠØ§.<br/>
                     ØªÙ… ØªØ·ÙˆÙŠØ±Ù‡Ø§ Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ‚Ù„ Ù…Ù† Ù…Ø·ÙˆÙ‘Ø± Ø³ÙˆØ±ÙŠ: <b>Zakaria KeFo</b>.<br/>
                     ØªØ¨Ø±Ø¹Ùƒ ÙŠØ³Ø§Ø¹Ø¯ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ© ÙˆØ§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©.`,
        donateBtn: "Ø§Ù„ØªØ¨Ø±Ø¹ Ø¹Ø¨Ø± PayPal",
        donateHint: "Ø³ÙŠØªÙ… ÙØªØ­ PayPal ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯.",

        aboutTitle: "Ø­ÙˆÙ„ KeFo AI",
        aboutText: `KeFo AI Ù…Ù† <b>KeFo.tech</b> Ù‡ÙŠ Ù…Ù†ØµØ© Ø¨Ø­Ø« Ø°ÙƒÙŠØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Wikipedia API Ù„ØªØ¨Ø³ÙŠØ· Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ø¹Ù„ÙˆÙ…Ø©.<br/>
                    Ø§Ù„ÙÙƒØ±Ø©: <b>Ø§Ù„Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø©</b> ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø´Ø±Ø­ Ù…Ø®ØªØµØ± Ø¨Ø³Ø±Ø¹Ø© Ø¯Ø§Ø®Ù„ ÙˆØ§Ø¬Ù‡Ø© Ø¯Ø±Ø¯Ø´Ø©.<br/>
                    Ø§Ù„Ù…Ø·ÙˆØ±: <b>Zakaria KeFo</b> (Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ) â€” Ù…Ø·ÙˆÙ‘Ø± Ø³ÙˆØ±ÙŠØŒ ÙˆØ§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø§Ù†ÙŠ.`,
        aboutKeywords: `ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ©: KeFo ai, KeFo.tech, Zakaria Kefo, Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ, Ø§Ù„Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø©, One Word Search AI`,
        seoInline: `KeFo.tech / KeFo AI â€” Ù…Ù†ØµØ© Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø© (One Word Search AI) ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Wikipedia API. ØªØ·ÙˆÙŠØ±: Zakaria KeFo (Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ).`,
        copyrightHtml: `Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© <a href="https://kefo.tech" target="_blank" rel="noopener">KeFo.tech</a>`
      },
      en: {
        welcomeMsg: "Type a term and I will show Wikipedia results in your selected language.",
        inputPlaceholder: "Type a word or phrase to search",
        searchBtn: "Search",
        noTerm: "â— Please type a search term",
        searching: "Searching...",
        results: "ğŸ“„ Results (click a title to view the summary):",
        fetching: "ğŸ”„ Fetching summary...",
        noResults: (t)=>`No results for: "${t}"`,
        searchErr: "âŒ Search error. Please try again later.",
        fetchErr: "âŒ Error fetching summary. Please try again later.",
        copyBtn: "Copy result",
        copied: "âœ… Done!",
        copyFail: "âŒ Copy failed!",
        signature: "By Zakaria KeFo",

        settingsTitle: "Settings",
        mode: "Mode",
        language: "Language",
        change: "Change",
        close: "Close",

        langPrompt: "Welcome, choose results language",
        langHint: "Your choice will be remembered next time.",
        currentLang: (code)=>({ar:"Arabic",en:"English",de:"German"}[code]||code),

        donateTitle: "Support the project",
        donateText: `This platform is free and helps access knowledge through Wikipedia.<br/>
                     Built independently by a Syrian developer: <b>Zakaria KeFo</b>.<br/>
                     Your donation supports hosting, improvements, and new features.`,
        donateBtn: "Donate via PayPal",
        donateHint: "PayPal will open in a new tab.",

        aboutTitle: "About KeFo AI",
        aboutText: `KeFo AI by <b>KeFo.tech</b> is a smart one-word search interface powered by the Wikipedia API.<br/>
                    Idea: <b>One Word Search AI</b> with fast summaries in a chat-style UI.<br/>
                    Developer: <b>Zakaria KeFo</b> (Syrian developer). This project is free.`,
        aboutKeywords: `Keywords: KeFo ai, KeFo.tech, Zakaria Kefo, Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ, one word search ai, Ø§Ù„Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø©`,
        seoInline: `KeFo.tech / KeFo AI â€” One Word Search AI powered by the Wikipedia API. Built by Zakaria KeFo (Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ).`,
        copyrightHtml: `All rights reserved Â© <a href="https://kefo.tech" target="_blank" rel="noopener">KeFo.tech</a>`
      },
      de: {
        welcomeMsg: "Gib einen Begriff ein, ich zeige Wikipedia-Ergebnisse in deiner gewÃ¤hlten Sprache.",
        inputPlaceholder: "Begriff oder Satz eingeben",
        searchBtn: "Suchen",
        noTerm: "â— Bitte einen Suchbegriff eingeben",
        searching: "Suche lÃ¤uft...",
        results: "ğŸ“„ Ergebnisse (Titel anklicken fÃ¼r Zusammenfassung):",
        fetching: "ğŸ”„ Zusammenfassung wird geladen...",
        noResults: (t)=>`Keine Ergebnisse fÃ¼r: "${t}"`,
        searchErr: "âŒ Suchfehler. Bitte spÃ¤ter erneut versuchen.",
        fetchErr: "âŒ Fehler beim Laden. Bitte spÃ¤ter erneut versuchen.",
        copyBtn: "Ergebnis kopieren",
        copied: "âœ… Fertig!",
        copyFail: "âŒ Kopieren fehlgeschlagen!",
        signature: "Von Zakaria KeFo",

        settingsTitle: "Einstellungen",
        mode: "Modus",
        language: "Sprache",
        change: "Ã„ndern",
        close: "SchlieÃŸen",

        langPrompt: "Willkommen, wÃ¤hle die Sprache der Ergebnisse",
        langHint: "Deine Auswahl wird beim nÃ¤chsten Ã–ffnen gespeichert.",
        currentLang: (code)=>({ar:"Arabisch",en:"Englisch",de:"Deutsch"}[code]||code),

        donateTitle: "Projekt unterstÃ¼tzen",
        donateText: `Diese Plattform ist kostenlos und erleichtert den Zugang zu Wissen Ã¼ber Wikipedia.<br/>
                     UnabhÃ¤ngig entwickelt von einem syrischen Entwickler: <b>Zakaria KeFo</b>.<br/>
                     Deine Spende unterstÃ¼tzt Hosting, Verbesserungen und neue Funktionen.`,
        donateBtn: "Ãœber PayPal spenden",
        donateHint: "PayPal Ã¶ffnet sich in einem neuen Tab.",

        aboutTitle: "Ãœber KeFo AI",
        aboutText: `KeFo AI von <b>KeFo.tech</b> ist eine smarte One-Word-Search OberflÃ¤che auf Basis der Wikipedia API.<br/>
                    Idee: <b>One Word Search AI</b> mit schnellen Kurzinfos im Chat-Design.<br/>
                    Entwickler: <b>Zakaria KeFo</b> (syrischer Entwickler). Dieses Projekt ist kostenlos.`,
        aboutKeywords: `SchlÃ¼sselwÃ¶rter: KeFo ai, KeFo.tech, Zakaria Kefo, Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ, One Word Search AI, Ø§Ù„Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø©`,
        seoInline: `KeFo.tech / KeFo AI â€” One Word Search AI basierend auf der Wikipedia API. Entwickelt von Zakaria KeFo (Ø²ÙƒØ±ÙŠØ§ ÙƒÙŠÙÙˆ).`,
        copyrightHtml: `Alle Rechte vorbehalten Â© <a href="https://kefo.tech" target="_blank" rel="noopener">KeFo.tech</a>`
      }
    };

    function T(key, ...args){
      const pack = uiText[uiLang] || uiText.en;
      const v = pack[key];
      return typeof v === 'function' ? v(...args) : v;
    }

    function applyUIText(){
      // Search UI
      userInput.placeholder = T('inputPlaceholder');
      sendBtn.textContent = T('searchBtn');

      // Settings labels
      document.getElementById('settingsTitle').textContent = T('settingsTitle');
      document.getElementById('themeRowLabel').textContent = T('mode');
      document.getElementById('langRowLabel').textContent = T('language');
      changeLangBtn.textContent = T('change');
      closeSettingsBtn.textContent = T('close');

      // Donate
      document.getElementById('donateTitle').textContent = T('donateTitle');
      document.getElementById('donateText').innerHTML = T('donateText');
      document.getElementById('paypalDonateLink').textContent = T('donateBtn');
      document.getElementById('donateHint').textContent = T('donateHint');
      closeDonateBtn.textContent = T('close');

      // About
      document.getElementById('aboutTitle').textContent = T('aboutTitle');
      document.getElementById('aboutText').innerHTML = T('aboutText');
      document.getElementById('aboutKeywords').textContent = T('aboutKeywords');
      closeAboutBtn.textContent = T('close');

      // Language modal
      langPrompt.textContent = T('langPrompt');
      document.getElementById('langHint').textContent = T('langHint');

      // Current wiki language label
      currentLangLabel.textContent = T('currentLang', wikiLang);

      // SEO inline text
      seoInlineText.textContent = T('seoInline');

      // Copyright localized (Ø¨Ø§Ù„Ù„ØºØ§Øª Ø§Ù„Ø«Ù„Ø§Ø«)
      copyrightBar.innerHTML = T('copyrightHtml');
    }

    /* =========================
       [7] Language modal (Wikipedia language)
       ========================= */
    function openLangModal(){ langModal.classList.add('open'); }
    function closeLangModal(){ langModal.classList.remove('open'); }

    function setWikiLang(langCode){
      wikiLang = langCode;
      localStorage.setItem(STORAGE_LANG, langCode);

      // Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø­Ø³Ø¨ Ù„ØºØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
      conversationContainer.style.direction = (wikiLang === 'ar') ? 'rtl' : 'ltr';

      applyUIText();
      keepLastLineVisible();
    }

    document.querySelectorAll('.lang-btn').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const lang = btn.getAttribute('data-lang');
        setWikiLang(lang);
        closeLangModal();
        showCopyNotification(T('copied'));
      });
    });

    changeLangBtn.addEventListener('click', ()=>{
      closeDrawer(settingsDrawer);
      openLangModal();
    });

    (function initLang(){
      const saved = localStorage.getItem(STORAGE_LANG);
      if (saved) setWikiLang(saved);
      else openLangModal();
    })();

    /* =========================
       [8] Wikipedia API helpers
       ========================= */
    function wikiBase(){
      return `https://${wikiLang}.wikipedia.org/w/api.php`;
    }

    /* =========================
       [9] Conversation helpers
       ========================= */
    function addMessageToConversation(message, isUser = false) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `message-bubble ${isUser ? 'user-bubble' : ''}`;
      messageDiv.textContent = message;

      conversationContainer.insertBefore(messageDiv, bottomAnchor);
      keepLastLineVisible();
    }

    function showCopyNotification(message) {
      const notification = document.createElement('div');
      notification.className = 'notification';
      notification.textContent = message;
      document.body.appendChild(notification);

      setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => { notification.remove(); }, 500);
      }, 1600);
    }

    function copyToClipboard(text) {
      navigator.clipboard.writeText(text)
        .then(() => showCopyNotification(T('copied')))
        .catch(() => showCopyNotification(T('copyFail')));
    }

    /* =========================
       [10] Search Wikipedia
       ========================= */
    async function searchWikipedia() {
      const searchTerm = userInput.value.trim();
      if (!searchTerm) {
        showCopyNotification(T('noTerm'));
        return;
      }

      if (!isMusicPlayed) {
        const audio = document.getElementById('background-music');
        audio.play().catch(() => {});
        isMusicPlayed = true;
      }

      addMessageToConversation(searchTerm, true);
      addMessageToConversation(T('searching'), false);

      const apiUrl = `${wikiBase()}?action=query&format=json&list=search&srsearch=${encodeURIComponent(searchTerm)}&origin=*`;

      try {
        const response = await fetch(apiUrl);
        const data = await response.json();
        const results = (data.query && data.query.search) ? data.query.search : [];
        displaySearchResults(results, searchTerm);
      } catch (error) {
        console.error("Search error:", error);
        addMessageToConversation(T('searchErr'), false);
      } finally {
        userInput.value = '';
        userInput.focus();
      }
    }

    function displaySearchResults(results, searchTerm) {
      if (!results || results.length === 0) {
        addMessageToConversation(T('noResults', searchTerm), false);
        return;
      }

      addMessageToConversation(T('results'), false);

      results.slice(0, 10).forEach((result, index) => {
        const resultDiv = document.createElement('div');
        resultDiv.className = 'message-bubble';
        resultDiv.textContent = `${index + 1}. ${result.title}`;
        resultDiv.style.cursor = 'pointer';
        resultDiv.onclick = () => fetchFullArticle(result.title);

        conversationContainer.insertBefore(resultDiv, bottomAnchor);
      });

      keepLastLineVisible();
    }

    /* =========================
       [11] Fetch summary + typing effect
       ========================= */
    async function fetchFullArticle(title) {
      addMessageToConversation(T('fetching'), false);

      const apiUrl = `${wikiBase()}?action=query&format=json&prop=extracts&exintro&explaintext&titles=${encodeURIComponent(title)}&origin=*`;

      try {
        const response = await fetch(apiUrl);
        const data = await response.json();
        const page = Object.values(data.query.pages)[0];
        const extract = page.extract || "No summary found.";

        const articleContainer = document.createElement('div');
        articleContainer.className = 'article-container';

        const typingEffectDiv = document.createElement('div');
        typingEffectDiv.className = 'typing-effect';
        articleContainer.appendChild(typingEffectDiv);

        conversationContainer.insertBefore(articleContainer, bottomAnchor);
        keepLastLineVisible();

        let i = 0;
        const speed = 10;

        function typeWriter() {
          if (i < extract.length) {
            typingEffectDiv.textContent += extract.charAt(i);
            i++;
            keepLastLineVisible();
            setTimeout(typeWriter, speed);
          } else {
            const signature = document.createElement('div');
            signature.className = 'signature';
            signature.textContent = T('signature');
            articleContainer.appendChild(signature);

            const copyBtn = document.createElement('button');
            copyBtn.className = 'copy-btn';
            copyBtn.textContent = T('copyBtn');
            copyBtn.onclick = () => copyToClipboard(extract + "\n" + T('signature'));
            articleContainer.appendChild(copyBtn);

            keepLastLineVisible();
          }
        }

        typeWriter();
      } catch (error) {
        console.error("Fetch error:", error);
        addMessageToConversation(T('fetchErr'), false);
      }
    }

    /* =========================
       [12] Events
       ========================= */
    sendBtn.addEventListener('click', searchWikipedia);
    userInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') searchWikipedia();
    });

    /* =========================
       [13] Anti-copy (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
       ========================= */
    document.addEventListener("contextmenu", e => e.preventDefault());
    document.addEventListener("selectstart", e => e.preventDefault());
    document.addEventListener("touchstart", e => {
      if (e.touches.length > 1) e.preventDefault();
    }, { passive: false });

    /* =========================
       [14] Init UI text + welcome message
       ========================= */
    applyUIText();
    addMessageToConversation(T('welcomeMsg'), false);

    /* =========================
       [15] Theme label update
       ========================= */
    (function initThemeLabel(){
      themeLabel.textContent = document.body.classList.contains('theme-light') ? 'Ù†Ù‡Ø§Ø±ÙŠ' : 'Ù„ÙŠÙ„ÙŠ';
    })();

    /* =========================
       [16] Hook buttons for drawers (About)
       ========================= */
    // ØªÙ… Ø§Ù„Ø±Ø¨Ø· Ø£Ø¹Ù„Ø§Ù‡ Ø¨Ø§Ù„ÙØ¹Ù„ Ø¹Ø¨Ø± addEventListener

    /* =========================
       [17] Persisted theme
       ========================= */
    // Ø§Ù„Ø«ÙŠÙ… Ù…Ø­ÙÙˆØ¸ ÙÙŠ localStorage Ø¹Ø¨Ø± applyTheme

  </script>
</body>
</html>
